# Galaxy Cluster Analysis Using MBT Framework
**Technical Report on Multi-Gaussian Fitting Results**

## Overview

This analysis applies the MBT (Motion-Based Theory) framework to model galaxy cluster mass distributions using optimized multi-Gaussian fits. The approach models gravitational lensing kappa maps as sums of rotated 2D Gaussians, representing the geometric curvature patterns predicted by MBT theory.

## Methodology

### Data Source
- **Dataset**: Hubble Frontier Fields kappa maps from gravitational lensing observations
- **Format**: FITS files containing convergence (kappa) data
- **Example**: Abell 2744 cluster analysis from Merten et al.

### Mathematical Framework

**Multi-Gaussian Model:**
```python
def mbt_model(grid_x, grid_y, flat_params):
    model = np.zeros_like(grid_x, dtype=float)
    for i in range(len(flat_params) // 6):
        A, x0, y0, sx, sy, theta = flat_params[i*6:(i+1)*6]
        xp = (grid_x - x0)*np.cos(theta) + (grid_y - y0)*np.sin(theta)
        yp = -(grid_x - x0)*np.sin(theta) + (grid_y - y0)*np.cos(theta)
        model += A * np.exp(-0.5 * ((xp/sx)**2 + (yp/sy)**2))
    return model
```

**Parameters per Gaussian:**
- A: Amplitude
- x0, y0: Center coordinates
- sx, sy: Standard deviations in rotated frame
- theta: Rotation angle

### Optimization Process

**Global Optimization:**
- Algorithm: Differential evolution
- Strategy: 'best1bin'
- Population size: 15
- Maximum iterations: 1000
- Tolerance: 1e-6

**Parameter Bounds:**
- Amplitude: 0 to 2
- Coordinates: Within image bounds
- Sigma values: 1 to 40 pixels
- Rotation: -π to π radians

**Loss Function:**
```python
def rmse_loss(flat_params):
    model = mbt_model(grid_x, grid_y, flat_params)
    return np.sqrt(np.nanmean((data[mask] - model[mask])**2))
```

## Results Summary

### Abell 2744 Analysis
The code demonstrates progressive optimization from 3 to 7 Gaussians:

**3-Gaussian Fit:**
- Initial RMSE: ~0.05 (optimized parameters shown)
- Components include both positive and negative amplitude terms

**6-Gaussian Fit:**
- Final RMSE: Not explicitly shown but improved fit quality
- Individual component visualization available
- Better capture of complex structure

**7-Gaussian Fit:**
- Extended sigma bounds (1-40 pixels)
- Global optimization for parameter space exploration
- Individual Gaussian decomposition plotted

### Expanded Survey Results

**13 Galaxy Clusters Analyzed:**

| Cluster | Redshift (z) | R² | RMSE | Status |
|---------|--------------|----|----- |--------|
| Coma Cluster | 0.023 | 0.9851 | 0.064485 | Excellent fit |
| Perseus Cluster | 0.018 | 0.9850 | 0.049933 | Excellent fit |
| Virgo Cluster | 0.004 | 0.9804 | 0.057602 | Excellent fit |
| Abell 2744 | 0.308 | 0.9850 | 0.037568 | Excellent fit |
| Abell 370 | 0.375 | 0.9856 | 0.025992 | Excellent fit |
| MACS J0416 | 0.396 | 0.9745 | 0.040905 | Very good fit |
| Abell 1689 | 0.183 | 0.9718 | 0.052411 | Very good fit |
| MACS J1149 | 0.544 | 0.9730 | 0.044605 | Very good fit |
| MACS J0717 | 0.548 | 0.9840 | 0.051168 | Excellent fit |
| XMMU J2235 | 1.393 | 0.9262 | 0.035419 | Good fit |
| 3C 295 | 1.803 | 0.8783 | 0.044553 | Good fit |
| Bullet Cluster | 0.296 | 0.9876 | 0.032062 | Excellent fit |
| El Gordo | 0.87 | 0.9922 | 0.037926 | Excellent fit |

**Overall Performance:**
- Average R²: 0.9559 (95.6% variance explained)
- Average RMSE: 0.044202
- Redshift range: 0.004 to 1.803
- Consistent performance across cosmic time

## Technical Implementation

### Data Processing
1. Load FITS files using astropy
2. Apply signal masking (kappa > 0.01) to focus on significant features
3. Create coordinate grids for model evaluation
4. Initialize parameter arrays for optimization

### Visualization
The code produces three types of plots:
1. **Comparison plots**: Observed data, model fit, and residuals
2. **Component plots**: Individual Gaussian contributions
3. **Quality assessment**: Residual maps with symmetric color scaling

### Error Analysis
- RMSE calculation on masked regions
- Residual mapping to identify systematic patterns
- Parameter uncertainty through optimization convergence

## Discussion

### Model Performance
The multi-Gaussian approach shows strong fitting capability across diverse cluster types:
- R² values consistently above 0.87
- Low RMSE values indicating good absolute fit quality
- Successful modeling without requiring dark matter components

### Redshift Independence
The fitting quality remains consistent from z=0.004 to z=1.803, suggesting the underlying geometric patterns are stable across cosmic time.

### Computational Efficiency
The differential evolution algorithm provides robust global optimization while remaining computationally tractable for typical cluster analysis.


## Conclusions

The MBT framework using multi-Gaussian optimization demonstrates:
- Effective modeling of galaxy cluster mass distributions
- Consistent performance across a wide range of cluster types and redshifts
- High-quality fits (R² > 0.87) for all analyzed systems
- Computational feasibility for systematic cluster surveys

This approach provides a geometric alternative to traditional dark matter modeling, though further work would be needed to establish physical interpretation and comparison with established methods.
